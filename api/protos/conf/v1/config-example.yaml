server:
  http:
    addr: "${HADDR:0.0.0.0:8000}"
    timeout: "${HTIMEOUT:1s}"
    tls:
      enable: ${HTLS_ENABLE:false}
      cert_path: "${HTTPS_CERT_PATH:../../manifest/certs/server.cert}"
      key_path: "${HTTPS_KEY_PATH:../../manifest/certs/server.key}"
    cors:
      enable: "${CORS_ENABLE:true}"
      allowed_origins: ["${CORS_ALLOWED_ORIGINS:*}"]
      allowed_methods: ["${CORS_ALLOWED_METHODS:GET,POST,PUT,DELETE,OPTIONS}"]
      allowed_headers:
        ["${CORS_ALLOWED_HEADERS:Origin,Content-Type,Accept,Authorization}"]
      exposed_headers: []
      allow_credentials: "${CORS_ALLOW_CREDENTIALS:false}"
      max_age: "${CORS_MAX_AGE:86400s}"
  grpc:
    addr: "${GADDR:0.0.0.0:8001}"
    timeout: "${GTIMEHOUT:1s}"
    tls:
      enable: ${GTLS_ENABLE:false}
      cert_path: "${GRPCS_CERT_PATH:../../manifest/certs/server.cert}"
      key_path: "${GRPCS_KEY_PATH:../../manifest/certs/server.key}"

data:
  database:
    driver: "${DB_DRIVER:mysql}"
    source: "${DB_SOURCE:projectName:123456@tcp(127.0.0.1:3306)/projectName?parseTime=True&loc=Local}"

    # PostgreSQL 配置示例:
    # driver: "postgres"
    # source: "host=localhost user=postgres password=password dbname=projectName port=5432 sslmode=disable"

    # SQLite 配置示例:
    # driver: "sqlite"
    # source: "file:./data.db?cache=shared&mode=rwc"
  redis:
    addr: "${RADDR:127.0.0.1:6379}"
    user_name: "${RUSER_NAME:}" # Redis用户名
    password: "${RPASSWORD:redisHoron}" # Redis密码
    db: "${RDB:5}" # Redis数据库编号
    dial_timeout: "${RDIAL_TIMEOUT:5s}" # Redis连接超时
    read_timeout: "${RREAD_TIMEOUT:0.2s}"
    write_timeout: "${RWRITE_TIMEOUT:0.2s}"
  client:
    # 这里可以配置第三方服务的客户端
    # 默认不用配置，而是在代码中直接服务发现
    grpc:
      # - service_name: hello.grpc  # nacos需要添加协议后缀
      #   endpoint: "${CLIENT_GRPC_ENDPOINT:127.0.0.1:8003}"
      #   timeout: ${CLIENT_GRPC_TIMEOUT:5s}

app:
  name: krathub
  version: v1.0.0
  env: "${ENV:dev}" # dev, test, prod
  metadata:
    key: value
  jwt:
    secret_key: "${JWT_SECRETK_KEY:projectName_secret}"
    expire: "${JWT_EXPIRE:24}"
    issuer: "${JWT_ISSUER:projectName}"
    # audience: "${JWT_AUDIENCE:projectName}"
  log:
    level: "${LOG_LEVEL:0}" # 0:debug, 1:info, 2:warn, 3:error, 4:fatal
    filename: "${LOG_FILENAME:projectName.log}" # 日志文件夹为根目录logs
    max_size: "${LOG_MAX_SIZE:20}" # 日志文件最大大小，单位MB
    max_age: "${LOG_MAX_AGE:30}" # 日志文件最大保存天数
    max_backups: "${LOG_MAX_BACKUPS:10}" # 日志文件最大备份数

# 注册中心配置 - 用于服务注册
registry:
  # 使用 Consul 作为注册中心
  consul:
    # Consul 服务器地址
    addr: "${REGISTRY_CONSUL_ADDR:consul.r430.com:30080}"
    # 通信协议 (http/https)
    scheme: "${REGISTRY_CONSUL_SCHEME:http}"
    # 数据中心名称
    datacenter: "${REGISTRY_CONSUL_DC:dc1}"
    # 连接超时时间
    timeout: "${REGISTRY_CONSUL_TIMEOUT:5s}"
    # 为服务自定义标签，可用于服务网格、负载均衡等
    tags:
      - "traefik.enable=true" # 启用 Traefik 路由
      - "traefik.http.routers.${APP_NAME:krathub}-router.rule=Host(`${DOMAIN:krathub.r430.com}`)" # 路由规则
      - "traefik.http.services.${APP_NAME:krathub}-svc.loadbalancer.server.port=${SERVER_HTTP_PORT:8000}" # 服务端口

  # 或者使用 etcd 作为注册中心
  # etcd:
  #   # etcd 端点列表
  #   endpoints:
  #     - "${REGISTRY_ETCD_ENDPOINTS_1:127.0.0.1:2379}"
  #     - "${REGISTRY_ETCD_ENDPOINTS_2:127.0.0.1:2380}"
  #     - "${REGISTRY_ETCD_ENDPOINTS_3:127.0.0.1:2381}"
  #   # 认证信息
  #   username: "${REGISTRY_ETCD_USERNAME:}"
  #   password: "${REGISTRY_ETCD_PASSWORD:}"
  #   # 连接超时时间
  #   timeout: "${REGISTRY_ETCD_TIMEOUT:5s}"
  #   # 命名空间（可选，默认为 /krathub）
  #   namespace: "${REGISTRY_ETCD_NAMESPACE:/krathub}"

  # 或者使用 Nacos 作为注册中心
  # nacos:
  # addr: "${NACOSR_ADDR:127.0.0.1}"
  # port: "${NACOSR_PORT:8848}"
  # namespace: "${NACOSR_NAMESPACE:public}"
  # group: "${NACOSR_GROUP:DEFAULT_GROUP}"
  # username: "${NACOSR_USERNAME:nacos}"
  # password: "${NACOSR_PASSWORD:nacos}"
  # timeout: "${NACOSR_TIMEOUT:5s}"

# 服务发现配置 - 用于服务发现，一般和注册中心配置相同
discovery:
  # 使用 Consul 作为服务发现
  consul:
    # Consul 服务器地址
    addr: "${DISCOVERY_CONSUL_ADDR:consul.r430.com:30080}"
    # 通信协议 (http/https)
    scheme: "${DISCOVERY_CONSUL_SCHEME:http}"
    # 数据中心名称
    datacenter: "${DISCOVERY_CONSUL_DC:dc1}"
    # 连接超时时间
    timeout: "${DISCOVERY_CONSUL_TIMEOUT:5s}"

  # 使用 etcd 作为服务发现
  # etcd:
  #   # etcd 端点列表
  #   endpoints:
  #     - "${DISCOVERY_ETCD_ENDPOINTS_1:127.0.0.1:2379}"
  #     - "${DISCOVERY_ETCD_ENDPOINTS_2:127.0.0.1:2380}"
  #     - "${DISCOVERY_ETCD_ENDPOINTS_3:127.0.0.1:2381}"
  #   # 认证信息
  #   username: "${DISCOVERY_ETCD_USERNAME:}"
  #   password: "${DISCOVERY_ETCD_PASSWORD:}"
  #   # 连接超时时间
  #   timeout: "${DISCOVERY_ETCD_TIMEOUT:5s}"
  #   # 命名空间（可选，默认为 /krathub，通常与注册中心保持一致）
  #   namespace: "${DISCOVERY_ETCD_NAMESPACE:/krathub}"

  # nacos:
  #   addr: "${NACOSD_ADDR:127.0.0.1}"
  #   port: "${NACOSD_PORT:8848}"
  #   namespace: "${NACOSD_NAMESPACE:public}"
  #   group: "${NACOSD_GROUP:DEFAULT_GROUP}"
  #   username: "${NACOSD_USERNAME:nacos}"
  #   password: "${NACOSD_PASSWORD:nacos}"
  #   timeout: "${NACOSD_TIMEOUT:5s}"

# 配置中心配置 - 用于动态配置管理
config:

  # 使用 Nacos 作为配置中心
  # nacos:
  #   addr: "${CONFIG_NACOS_ADDR:127.0.0.1}"
  #   port: "${CONFIG_NACOS_PORT:8848}"
  #   namespace: "${CONFIG_NACOS_NAMESPACE:public}"
  #   group: "${CONFIG_NACOS_GROUP:DEFAULT_GROUP}"
  #   data_id: "${CONFIG_NACOS_DATA_ID:${APP_NAME:projectName}.yaml}"
  #   username: "${CONFIG_NACOS_USERNAME:nacos}"
  #   password: "${CONFIG_NACOS_PASSWORD:nacos}"
  #   timeout: "${CONFIG_NACOS_TIMEOUT:5s}"

  # 使用 Consul 作为配置中心
  # consul:
  #   # Consul 服务器地址
  #   addr: "${CONFIG_CONSUL_ADDR:consul.r430.com:30080}"
  #   # 通信协议 (http/https)
  #   scheme: "${CONFIG_CONSUL_SCHEME:http}"
  #   # 数据中心名称
  #   datacenter: "${CONFIG_CONSUL_DC:dc1}"
  #   # 连接超时时间
  #   timeout: "${CONFIG_CONSUL_TIMEOUT:5s}"
  #   # 配置键名，建议格式：应用名/环境.config.yaml
  #   key: "${CONFIG_CONSUL_KEY:${APP_NAME:projectName}/config.yaml}"

  # 使用 Etcd 作为配置中心
  # etcd:
  #   endpoints:
  #     - "${CONFIG_ETCD_ENDPOINTS:127.0.0.1:2379}"
  #   username: "${CONFIG_ETCD_USERNAME:}"
  #   password: "${CONFIG_ETCD_PASSWORD:}"
  #   timeout: "${CONFIG_ETCD_TIMEOUT:5s}"
  #   # 配置路径 (推荐)
  #   key: "${CONFIG_ETCD_KEY:/krathub/config.yaml}"
  #   # 或者使用 namespace (自动拼接为 {namespace}/config.yaml)
  #   # namespace: "${CONFIG_ETCD_NAMESPACE:/krathub}"

# 链路追踪配置
trace:
  # 使用 Jaeger 作为链路追踪
  endpoint: "${TRACE_JAEGER_ENDPOINT:otlp.jaeger.r430.com:30080}"
# 监控配置
metrics:
  enable: ${METRICS_ENABLE:true}
  meter_name: "${METER_NAME:krathub}"
